<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="ranking">

	<!-- 한 달 점수 랭킹 (상위 10명) -->
	<select id="monthlyrank" parameterType="rankingvo" resultType="rankingvo">
		<![CDATA[
			select rank, id, monthlyscore 
			from (select rank() over(order by score desc) as rank, id, 
			score as monthlyScore from scores, member 
			where member.no = scores.member_no) where rownum<=10
		]]>
	</select>

	<!-- 나의 한 달 점수 랭킹 -->
	<select id="mymonthlyrank" parameterType="long" resultType="rankingvo">
		<![CDATA[
			select rank, id, myMonthlyscore 
			from (select rank() over(order by score desc) rank, id, no, 
			score as myMonthlyScore from scores, member 
			where member.no = scores.member_no) where no=#{no}
		]]>
	</select>

	<!-- 종합 점수 랭킹 (명예의 전당) -->
	<select id="honor" parameterType="rankingvo" resultType="rankingvo">
		<![CDATA[
			select rank, id, totalscore 
			from (select rank() over(order by scores.total_score desc) as rank, 
			id, scores.total_score as totalscore from scores, member 
			where member.no = scores.member_no) where rownum<=10
		]]>
	</select>

	<!-- 나의 종합 점수 랭킹 (명예의 전당) -->
	<select id="myTotalRank" parameterType="long" resultType="rankingvo">
		<![CDATA[
			select rank, id, myTotalScore 
			from (select rank() over(order BY scores.total_score desc) rank, 
			id, no, scores.total_score as myTotalScore 
			from scores, member where member.no = scores.member_no) 
			where no=#{no}			
		]]>
	</select>

	<!-- 종합 점수 랭킹 (top 3) -->
	<select id="totalTopRanker" parameterType="rankingvo" resultType="rankingvo">
		<![CDATA[
			select rank, id 
			from (select rank() OVER(order BY scores.total_score desc) as rank, 
			id, scores.total_score as totalscore from scores, member 
			where member.no = scores.member_no) 
			where rownum<=3 order by rank asc			
		]]>
	</select>

	<!-- 학교별 랭킹 -->
	<select id="schoolrank" parameterType="rankingvo" resultType="rankingvo">
		<![CDATA[
			
		]]>
	</select>

	<!-- 학년별 랭킹 -->
	<select id="graderank" parameterType="rankingvo" resultType="rankingvo">
		<![CDATA[
			
		]]>
	</select>
	
</mapper>