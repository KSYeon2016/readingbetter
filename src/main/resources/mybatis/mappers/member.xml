<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="member">

	<select id="list" parameterType="membervo" resultType="membervo">
		<![CDATA[
			select no, id, name, penalty from member 
			where id like '%' || #{kwd} || '%' order by no asc
		]]>
	</select>
	
	<select id="selectAuthUser" parameterType="membervo" resultType="membervo">
		<![CDATA[
			select no, name, id, pw, last_date as lastDate, position, 
			email, tel, penalty, grade, class_no as classNo, 
			school_no as schoolNo from member where id=#{id} and pw=#{pw}
		]]>
	</select>

	<select id="checkId" parameterType="string" resultType="membervo">
		<![CDATA[
			select id from member where id=#{id}
		]]>
	</select>

	<select id="checkEmail" parameterType="string" resultType="membervo">
		<![CDATA[
			select email from member where email=#{email}
		]]>
	</select>

	<insert id="insertMember" parameterType="membervo">
		<![CDATA[
			insert into member values(seq_member.nextval, #{id}, #{pw}, #{name}, #{email}, #{tel}, sysdate, 1, 0, #{grade}, #{classNo}, (select no from school where title=#{schoolName}))
		]]>
	</insert>
	
	<select id="selectMyinfo" parameterType="long" resultType="membervo">
		<![CDATA[
			select m.name, m.email, m.tel, s.title as schoolName, m.grade, m.class_no as classNo
				from member m, school s 
				where m.SCHOOL_NO = s.NO and m.no=#{no}
		]]>
	</select>
	
	<delete id="delete" parameterType="long">
		<![CDATA[
			delete from member where no=#{no}
		]]>
	</delete>
	
</mapper>