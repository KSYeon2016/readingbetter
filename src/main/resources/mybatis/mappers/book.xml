<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="book">

	<select id="list" parameterType="bookvo" resultType="bookvo">
		<![CDATA[
			select a.no, a.title, a.recommend, a.cover, 
			b.title as publisherTitle, c.name as authorName 
			from book a, publisher b, author c
 			where b.no=a.publisher_no and c.no=a.author_no order by a.no desc
		]]>
	</select>

	<select id="listpage" parameterType="bookvo" resultType="bookvo">
		<![CDATA[
			select * from (select rownum as rnum, a.no, a.title, a.recommend, 
			a.cover, b.title as publisherTitle, c.name as authorName 
			from book a, publisher b,author c 
 			where b.no=a.publisher_no and c.no=a.author_no 
 			order by a.no desc) 
 			where (#{pageNo}-1)*3+1<=rnum and rnum<=#{pageNo}*3   				
		]]>
	</select>

	<select id="listkwd" parameterType="bookvo" resultType="bookvo">
		<![CDATA[
			select * from (select rownum as rnum, a.no, a.title, a.recommend, 
			a.cover, b.title as publisherTitle, c.name as authorName 
			from book a, publisher b, author c 
			where b.no=a.publisher_no and c.no=a.author_no 
			and a.title like '%' || #{bkwd} || '%' order by a.title) 
			where (#{pageNo}-1)*3+1<=rnum and rnum<=#{pageNo}*3
		]]>
	</select>

	<select id="getByNo" parameterType="long" resultType="bookvo">
		<![CDATA[
			select a.no, a.title, a.recommend, a.cover, 
			b.title as publisherTitle, c.name as authorName 
			from book a, publisher b, author c
 			where b.no=a.publisher_no and c.no=a.author_no and a.no=#{no}
		]]>
	</select>

	<select id="findBook" parameterType="bookvo" resultType="bookvo">
		<![CDATA[
			select * from book where title 
			like '%' || #{bkwd} || '%' order by no asc
		]]>
	</select>

</mapper>